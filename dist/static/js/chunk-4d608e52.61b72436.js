(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d608e52"],{"0d5a":function(e,a,t){},"36c4":function(e,a,t){"use strict";var n=t("0d5a"),s=t.n(n);s.a},"531f":function(e,a,t){"use strict";t.d(a,"b",(function(){return s})),t.d(a,"a",(function(){return r})),t.d(a,"c",(function(){return o}));var n=t("b775");function s(e){return Object(n["a"])({url:"/cultures/system/qiniuUploadImage",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/cultures/system/qiniuGetTokenAndKey",method:"post",data:e})}function o(e){return Object(n["a"])({url:"https://up.qiniup.com",method:"post",data:e})}},5915:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"body-section-avatar"},[t("div",{staticClass:"demo-basic--circle"},[t("div",{staticClass:"block"},[t("el-avatar",{attrs:{size:70,src:e.userInfo.avatar}})],1),e._v(" "),t("el-dialog",{attrs:{title:"更换头像",visible:e.changeAvatarDialog,width:"30%"},on:{"update:visible":function(a){e.changeAvatarDialog=a}}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{"http-request":e.myUpload,action:"","before-upload":e.beforeUpload,"show-file-list":!1}},[e.uploadImageData.url?t("img",{staticClass:"avatar",attrs:{src:e.uploadImageData.url}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.changeAvatarDialog=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.updateUserAvatar}},[e._v("确 定")])],1)],1)],1)]),e._v(" "),t("el-divider",[t("i",{staticClass:"el-icon-user",on:{click:function(a){e.changeAvatarDialog=!0}}})]),e._v(" "),t("el-row",{staticStyle:{"margin-bottom":"40px"},attrs:{gutter:20}},[t("el-col",{attrs:{span:6,offset:1}},[t("el-card",{staticClass:"left-menu",attrs:{shadow:"hover"}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("p",{staticStyle:{"text-align":"right"}},[e._v("\n              用户名：\n            ")])]),e._v(" "),t("el-col",{staticStyle:{"text-align":"left","line-height":"50px"},attrs:{span:18}},[e.changeUsernameFlag?t("div",[t("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请输入新用户名"},model:{value:e.newUsername,callback:function(a){e.newUsername=a},expression:"newUsername"}}),e._v(" "),t("i",{staticClass:"el-icon-check",on:{click:e.updateUsername}}),e._v(" "),t("i",{staticClass:"el-icon-close",on:{click:function(a){e.changeUsernameFlag=!1}}})],1):e._e(),e._v(" "),e.changeUsernameFlag?e._e():t("div",[t("el-link",{staticStyle:{"font-size":"16px"},attrs:{disabled:""}},[e._v(e._s(e.userInfo.username))]),e._v(" "),t("i",{staticClass:"el-icon-edit",on:{click:function(a){e.changeUsernameFlag=!0}}})],1)])],1),e._v(" "),e.userInfo.email?t("el-row",[t("el-col",{attrs:{span:6}},[t("p",{staticStyle:{"text-align":"right"}},[e._v("\n              邮箱：\n            ")])]),e._v(" "),t("el-col",{staticStyle:{"text-align":"left","line-height":"50px"},attrs:{span:18}},[t("el-link",{staticStyle:{"font-size":"16px"},attrs:{disabled:""}},[e._v(e._s(e.userInfo.email))])],1)],1):e._e(),e._v(" "),e.userInfo.mobile?t("el-row",[t("el-col",{attrs:{span:6}},[t("p",{staticStyle:{"text-align":"right"}},[e._v("\n              手机号：\n            ")])]),e._v(" "),t("el-col",[t("el-link",{attrs:{disabled:""}},[e._v(e._s(e.userInfo.mobile))])],1)],1):e._e()],1)],1),e._v(" "),t("el-col",{attrs:{span:15,offset:1}},[t("el-card",{attrs:{shadow:"hover"}},[e._v("\n        用户其他内容\n      ")])],1)],1)],1)},s=[],r=(t("96cf"),t("3b8d")),o=t("531f"),l=t("2d8e"),i={data:function(){return{userInfo:{avatar:"",username:"",email:"",mobile:""},uploadImageData:{uploadToken:"",uploadKey:"",url:""},newAvatarUrl:"",changeAvatarDialog:!1,changeUsernameFlag:!1,newUsername:""}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var e=this;this.$store.dispatch("user/getInfo").then((function(a){e.userInfo=a,e.newUsername=e.userInfo.username}))},beforeUpload:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])({category:1,scene:"avatar"}).then((function(e){a.uploadImageData.uploadKey=e.data.key,a.uploadImageData.uploadToken=e.data.token,a.uploadImageData.url=e.data.url}));case 2:case"end":return e.stop()}}),e)})));function a(){return e.apply(this,arguments)}return a}(),myUpload:function(e){var a=this,t=new FormData;t.append("file",e.file),t.append("key",this.uploadImageData.uploadKey),t.append("token",this.uploadImageData.uploadToken),Object(o["c"])(t).then((function(e){a.$message({message:"上传成功",type:"success"})}))},updateUserAvatar:function(){var e=this;if(""===this.uploadImageData.url)throw this.$message.error("请先上传头像"),new Error("请先上传头像");Object(l["f"])({avatar:this.uploadImageData.url}).then((function(a){e.$message({message:"更换成功",type:"success"}),e.changeAvatarDialog=!1,e.userInfo.avatar=e.uploadImageData.url}))},updateUsername:function(){var e=this;Object(l["g"])({username:this.newUsername}).then((function(a){e.userInfo.username=e.newUsername,e.$message({message:"更改成功",type:"success"}),e.changeUsernameFlag=!1}))}}},c=i,u=(t("36c4"),t("2877")),d=Object(u["a"])(c,n,s,!1,null,"3308da1a",null);a["default"]=d.exports}}]);